# ARIS Project - Cursor Rules

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

**ARIS (Advanced Request & Issue Management System)**
IT í”„ë¡œì íŠ¸ì˜ SR(Service Request), SPEC, ìŠ¹ì¸, ì¥ì•  ë“±ì„ í†µí•© ê´€ë¦¬í•˜ëŠ” ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ê´€ë¦¬ ì‹œìŠ¤í…œ

### ê¸°ìˆ  ìŠ¤íƒ
- **Backend**: Spring Boot 3.x (Java 17)
- **Database**: PostgreSQL 15+
- **Infrastructure**: Docker & Docker Compose
- **Authentication**: JWT (JSON Web Token)
- **ORM**: Spring Data JPA
- **Migration**: Flyway
- **Documentation**: Swagger/OpenAPI 3.0
- **Testing**: JUnit 5, Mockito, TestContainers

---

## ğŸ¯ MVP 3ë‹¨ê³„ ì „ëµ

### Phase 1: í•µì‹¬ ê¸°ë°˜ (Core Foundation)
- ì‚¬ìš©ì ì¸ì¦/ì¸ê°€ (JWT)
- ê¶Œí•œ ê´€ë¦¬ (RBAC)
- ì‚¬ìš©ì ê´€ë¦¬
- ê¸°ë³¸ UI í”„ë ˆì„ì›Œí¬

### Phase 2: í•µì‹¬ ì—…ë¬´ íë¦„ (Core Business Flow)
- IT ì‚¬ì—…/í”„ë¡œì íŠ¸ ê´€ë¦¬
- SR ê´€ë¦¬ (ê°œë°œ/ìš´ì˜)
- SPEC ê´€ë¦¬
- ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤

### Phase 3: í™•ì¥ ê¸°ëŠ¥ (Extended Features)
- ì´ìŠˆ ê´€ë¦¬
- ë¦´ë¦¬ì¦ˆ ê´€ë¦¬
- ì¥ì• /ì¸ì‹œë˜íŠ¸ ê´€ë¦¬
- í†µê³„ ë° ë¦¬í¬íŠ¸
- íŒŒíŠ¸ë„ˆ/ìì‚° ê´€ë¦¬
- ì•Œë¦¼ ë° ë°°ì¹˜

---

## ğŸ—ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
ARIS/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/main/java/com/aris/
â”‚   â”‚   â”œâ”€â”€ domain/              # ë„ë©”ì¸ë³„ íŒ¨í‚¤ì§€
â”‚   â”‚   â”‚   â”œâ”€â”€ user/            # ì‚¬ìš©ì ë„ë©”ì¸
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ entity/      # JPA Entity
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dto/         # DTO (Request/Response)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ repository/  # Repository Interface
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ service/     # Business Logic
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ controller/  # REST Controller
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/            # ì¸ì¦/ì¸ê°€
â”‚   â”‚   â”‚   â”œâ”€â”€ project/         # í”„ë¡œì íŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ sr/              # SR ê´€ë¦¬
â”‚   â”‚   â”‚   â”œâ”€â”€ spec/            # SPEC ê´€ë¦¬
â”‚   â”‚   â”‚   â””â”€â”€ approval/        # ìŠ¹ì¸
â”‚   â”‚   â””â”€â”€ global/              # ê³µí†µ ëª¨ë“ˆ
â”‚   â”‚       â”œâ”€â”€ config/          # Configuration
â”‚   â”‚       â”œâ”€â”€ security/        # Security ì„¤ì •
â”‚   â”‚       â”œâ”€â”€ exception/       # ì˜ˆì™¸ ì²˜ë¦¬
â”‚   â”‚       â”œâ”€â”€ common/          # ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”‚   â”‚       â””â”€â”€ entity/          # BaseEntity ë“±
â”‚   â”œâ”€â”€ src/main/resources/
â”‚   â”‚   â”œâ”€â”€ application.yml      # ì„¤ì • íŒŒì¼
â”‚   â”‚   â”œâ”€â”€ application-dev.yml  # ê°œë°œ í™˜ê²½
â”‚   â”‚   â”œâ”€â”€ application-prod.yml # ìš´ì˜ í™˜ê²½
â”‚   â”‚   â””â”€â”€ db/migration/        # Flyway migrations
â”‚   â””â”€â”€ src/test/                # í…ŒìŠ¤íŠ¸ ì½”ë“œ
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .cursorrules
â””â”€â”€ docs/
    â”œâ”€â”€ MVP_3Phase_Plan.md
    â”œâ”€â”€ Database_Schema_Design.md
    â”œâ”€â”€ API_Specification.md
    â””â”€â”€ Development_Guide.md
```

---

## ğŸ’» ì½”ë”© ì»¨ë²¤ì…˜

### 1. ë„¤ì´ë° ê·œì¹™

#### Java Class/Interface
```java
// Entity
public class User extends BaseEntity { }
public class ServiceRequest extends BaseEntity { }

// DTO - Request
public class UserCreateRequest { }
public class SrCreateRequest { }

// DTO - Response
public class UserResponse { }
public class SrDetailResponse { }

// Repository
public interface UserRepository extends JpaRepository<User, Long> { }

// Service
@Service
public class UserService { }

// Controller
@RestController
@RequestMapping("/api/users")
public class UserController { }
```

#### ë³€ìˆ˜ëª…
```java
// Camel Case
private String userName;
private Long userId;
private LocalDateTime createdAt;

// Booleanì€ is/has ì ‘ë‘ì‚¬
private boolean isActive;
private boolean hasPermission;

// Collectionì€ ë³µìˆ˜í˜•
private List<User> users;
private Set<Role> roles;
```

#### ë©”ì„œë“œëª…
```java
// CRUD
public User create(UserCreateRequest request)
public User findById(Long id)
public User update(Long id, UserUpdateRequest request)
public void delete(Long id)

// Query
public List<User> findAllByCompany(String companyName)
public Optional<User> findByEmail(String email)

// Business Logic
public void assignRole(Long userId, Long roleId)
public void activateUser(Long userId)
public boolean validatePassword(String rawPassword, String encodedPassword)
```

### 2. ë ˆì´ì–´ë³„ ì±…ì„

#### Controller Layer
- HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
- DTO ë³€í™˜
- ê°„ë‹¨í•œ ìœ íš¨ì„± ê²€ì¦ (`@Valid`)
- ì˜ˆì™¸ëŠ” GlobalExceptionHandlerì—ê²Œ ìœ„ì„

```java
@RestController
@RequestMapping("/api/users")
@RequiredArgsConstructor
@Tag(name = "User", description = "ì‚¬ìš©ì ê´€ë¦¬ API")
public class UserController {
    
    private final UserService userService;
    
    @PostMapping
    @Operation(summary = "ì‚¬ìš©ì ë“±ë¡", description = "ìƒˆë¡œìš´ ì‚¬ìš©ìë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.")
    public ResponseEntity<UserResponse> createUser(
            @Valid @RequestBody UserCreateRequest request) {
        UserResponse response = userService.createUser(request);
        return ResponseEntity.status(HttpStatus.CREATED).body(response);
    }
}
```

#### Service Layer
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„
- íŠ¸ëœì­ì…˜ ê´€ë¦¬ (`@Transactional`)
- ë„ë©”ì¸ ê·œì¹™ ê²€ì¦
- ì—¬ëŸ¬ Repository ì¡°í•©

```java
@Service
@RequiredArgsConstructor
@Transactional(readOnly = true)
public class UserService {
    
    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;
    
    @Transactional
    public UserResponse createUser(UserCreateRequest request) {
        // ì¤‘ë³µ ê²€ì¦
        if (userRepository.existsByEmail(request.getEmail())) {
            throw new DuplicateEmailException("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼ì…ë‹ˆë‹¤.");
        }
        
        // Entity ìƒì„±
        User user = User.builder()
                .email(request.getEmail())
                .password(passwordEncoder.encode(request.getPassword()))
                .name(request.getName())
                .build();
        
        // ì €ì¥ ë° ë°˜í™˜
        User savedUser = userRepository.save(user);
        return UserResponse.from(savedUser);
    }
}
```

#### Repository Layer
- ë°ì´í„° ì ‘ê·¼ ë¡œì§
- Query Method ë˜ëŠ” @Query ì‚¬ìš©
- ë³µì¡í•œ ë™ì  ì¿¼ë¦¬ëŠ” QueryDSL í™œìš©

```java
@Repository
public interface UserRepository extends JpaRepository<User, Long> {
    
    Optional<User> findByEmail(String email);
    
    boolean existsByEmail(String email);
    
    @Query("SELECT u FROM User u WHERE u.company.id = :companyId AND u.deletedAt IS NULL")
    List<User> findActiveUsersByCompany(@Param("companyId") Long companyId);
}
```

### 3. Entity ì„¤ê³„ ì›ì¹™

```java
@Entity
@Table(name = "users")
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
@EntityListeners(AuditingEntityListener.class)
public class User extends BaseEntity {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(nullable = false, unique = true, length = 100)
    private String email;
    
    @Column(nullable = false)
    private String password;
    
    @Column(nullable = false, length = 50)
    private String name;
    
    @Column(length = 20)
    private String phoneNumber;
    
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "company_id")
    private Company company;
    
    @ManyToMany
    @JoinTable(
        name = "user_roles",
        joinColumns = @JoinColumn(name = "user_id"),
        inverseJoinColumns = @JoinColumn(name = "role_id")
    )
    private Set<Role> roles = new HashSet<>();
    
    @Builder
    public User(String email, String password, String name, String phoneNumber, Company company) {
        this.email = email;
        this.password = password;
        this.name = name;
        this.phoneNumber = phoneNumber;
        this.company = company;
    }
    
    // Business Methods
    public void changePassword(String newPassword) {
        this.password = newPassword;
    }
    
    public void assignRole(Role role) {
        this.roles.add(role);
    }
}
```

#### BaseEntity (ê³µí†µ ì—”í‹°í‹°)
```java
@Getter
@MappedSuperclass
@EntityListeners(AuditingEntityListener.class)
public abstract class BaseEntity {
    
    @CreatedDate
    @Column(nullable = false, updatable = false)
    private LocalDateTime createdAt;
    
    @CreatedBy
    @Column(nullable = false, updatable = false, length = 50)
    private String createdBy;
    
    @LastModifiedDate
    @Column(nullable = false)
    private LocalDateTime updatedAt;
    
    @LastModifiedBy
    @Column(nullable = false, length = 50)
    private String updatedBy;
    
    @Column
    private LocalDateTime deletedAt;
    
    @Version
    private Long version;
    
    // Soft Delete
    public void delete() {
        this.deletedAt = LocalDateTime.now();
    }
    
    public boolean isDeleted() {
        return deletedAt != null;
    }
}
```

### 4. DTO íŒ¨í„´

```java
// Request DTO
@Getter
@NoArgsConstructor
public class UserCreateRequest {
    
    @NotBlank(message = "ì´ë©”ì¼ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    @Email(message = "ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.")
    private String email;
    
    @NotBlank(message = "ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")
    @Size(min = 8, max = 20, message = "ë¹„ë°€ë²ˆí˜¸ëŠ” 8~20ìì—¬ì•¼ í•©ë‹ˆë‹¤.")
    private String password;
    
    @NotBlank(message = "ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    @Size(max = 50, message = "ì´ë¦„ì€ 50ì ì´ë‚´ì—¬ì•¼ í•©ë‹ˆë‹¤.")
    private String name;
    
    @Pattern(regexp = "^01[0-9]-[0-9]{4}-[0-9]{4}$", message = "ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.")
    private String phoneNumber;
    
    private Long companyId;
}

// Response DTO
@Getter
@Builder
public class UserResponse {
    private Long id;
    private String email;
    private String name;
    private String phoneNumber;
    private String companyName;
    private List<String> roles;
    private LocalDateTime createdAt;
    
    public static UserResponse from(User user) {
        return UserResponse.builder()
                .id(user.getId())
                .email(user.getEmail())
                .name(user.getName())
                .phoneNumber(user.getPhoneNumber())
                .companyName(user.getCompany() != null ? user.getCompany().getName() : null)
                .roles(user.getRoles().stream()
                        .map(Role::getName)
                        .collect(Collectors.toList()))
                .createdAt(user.getCreatedAt())
                .build();
    }
}
```

### 5. ì˜ˆì™¸ ì²˜ë¦¬ ì „ëµ

```java
// Custom Exception
public class BusinessException extends RuntimeException {
    private final ErrorCode errorCode;
    
    public BusinessException(ErrorCode errorCode) {
        super(errorCode.getMessage());
        this.errorCode = errorCode;
    }
}

// Error Code
@Getter
@RequiredArgsConstructor
public enum ErrorCode {
    // User
    USER_NOT_FOUND("U001", "ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),
    DUPLICATE_EMAIL("U002", "ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼ì…ë‹ˆë‹¤."),
    INVALID_PASSWORD("U003", "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."),
    
    // Auth
    UNAUTHORIZED("A001", "ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤."),
    FORBIDDEN("A002", "ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."),
    INVALID_TOKEN("A003", "ìœ íš¨í•˜ì§€ ì•Šì€ í† í°ì…ë‹ˆë‹¤."),
    
    // Common
    INVALID_INPUT("C001", "ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤."),
    INTERNAL_SERVER_ERROR("C999", "ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    
    private final String code;
    private final String message;
}

// Global Exception Handler
@RestControllerAdvice
@Slf4j
public class GlobalExceptionHandler {
    
    @ExceptionHandler(BusinessException.class)
    public ResponseEntity<ErrorResponse> handleBusinessException(BusinessException e) {
        log.error("BusinessException: {}", e.getMessage());
        ErrorResponse response = ErrorResponse.of(e.getErrorCode());
        return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(response);
    }
    
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<ErrorResponse> handleValidationException(MethodArgumentNotValidException e) {
        log.error("ValidationException: {}", e.getMessage());
        ErrorResponse response = ErrorResponse.of(ErrorCode.INVALID_INPUT, e.getBindingResult());
        return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(response);
    }
    
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> handleException(Exception e) {
        log.error("Unexpected Exception: {}", e.getMessage(), e);
        ErrorResponse response = ErrorResponse.of(ErrorCode.INTERNAL_SERVER_ERROR);
        return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(response);
    }
}
```

---

## ğŸ” ë³´ì•ˆ ê°€ì´ë“œë¼ì¸

### 1. JWT ì¸ì¦ êµ¬í˜„
```java
@Component
@RequiredArgsConstructor
public class JwtTokenProvider {
    
    @Value("${jwt.secret}")
    private String secretKey;
    
    @Value("${jwt.access-token-validity}")
    private long accessTokenValidity;
    
    @Value("${jwt.refresh-token-validity}")
    private long refreshTokenValidity;
    
    public String createAccessToken(String email, List<String> roles) {
        Claims claims = Jwts.claims().setSubject(email);
        claims.put("roles", roles);
        
        Date now = new Date();
        Date validity = new Date(now.getTime() + accessTokenValidity);
        
        return Jwts.builder()
                .setClaims(claims)
                .setIssuedAt(now)
                .setExpiration(validity)
                .signWith(SignatureAlgorithm.HS256, secretKey)
                .compact();
    }
}
```

### 2. Security Configuration
```java
@Configuration
@EnableWebSecurity
@EnableMethodSecurity
@RequiredArgsConstructor
public class SecurityConfig {
    
    private final JwtTokenProvider jwtTokenProvider;
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .csrf(csrf -> csrf.disable())
            .sessionManagement(session -> 
                session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/api/auth/**").permitAll()
                .requestMatchers("/swagger-ui/**", "/v3/api-docs/**").permitAll()
                .anyRequest().authenticated())
            .addFilterBefore(new JwtAuthenticationFilter(jwtTokenProvider), 
                UsernamePasswordAuthenticationFilter.class);
        
        return http.build();
    }
    
    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}
```

### 3. ë©”ì„œë“œ ë ˆë²¨ ë³´ì•ˆ
```java
@Service
@RequiredArgsConstructor
public class UserService {
    
    @PreAuthorize("hasRole('ADMIN')")
    public void deleteUser(Long userId) {
        // Only ADMIN can delete users
    }
    
    @PreAuthorize("hasRole('ADMIN') or #userId == authentication.principal.id")
    public UserResponse getUserDetail(Long userId) {
        // ADMIN can view anyone, users can view their own profile
    }
}
```

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì›ì¹™

### 1. Soft Delete ì›ì¹™
- ëª¨ë“  ì—”í‹°í‹°ëŠ” `BaseEntity`ë¥¼ ìƒì†
- ë¬¼ë¦¬ì  ì‚­ì œ ê¸ˆì§€, `deletedAt` í•„ë“œë¡œ ë…¼ë¦¬ì  ì‚­ì œ
- ì¡°íšŒ ì‹œ `deletedAt IS NULL` ì¡°ê±´ í•„ìˆ˜

### 2. Auditing ìë™í™”
```java
@Configuration
@EnableJpaAuditing
public class JpaConfig {
    
    @Bean
    public AuditorAware<String> auditorProvider() {
        return () -> {
            Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
            if (authentication == null || !authentication.isAuthenticated()) {
                return Optional.of("system");
            }
            return Optional.of(authentication.getName());
        };
    }
}
```

### 3. ì¸ë±ìŠ¤ ì „ëµ
```java
@Entity
@Table(name = "users", indexes = {
    @Index(name = "idx_user_email", columnList = "email"),
    @Index(name = "idx_user_company", columnList = "company_id"),
    @Index(name = "idx_user_deleted", columnList = "deleted_at")
})
public class User extends BaseEntity {
    // ...
}
```

### 4. ì—°ê´€ê´€ê³„ ë§¤í•‘
- `@ManyToOne`: ê¸°ë³¸ `FetchType.LAZY`
- `@OneToMany`: ê¸°ë³¸ `FetchType.LAZY` (ë³€ê²½ ê¸ˆì§€)
- N+1 ë¬¸ì œ ë°œìƒ ì‹œ `@EntityGraph` ë˜ëŠ” `JOIN FETCH` ì‚¬ìš©
- ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ëŠ” ê¼­ í•„ìš”í•œ ê²½ìš°ë§Œ ì‚¬ìš©

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì „ëµ

### 1. í…ŒìŠ¤íŠ¸ êµ¬ì¡°
```
src/test/java/com/aris/
â”œâ”€â”€ domain/
â”‚   â””â”€â”€ user/
â”‚       â”œâ”€â”€ controller/
â”‚       â”‚   â””â”€â”€ UserControllerTest.java  # MockMvc
â”‚       â”œâ”€â”€ service/
â”‚       â”‚   â””â”€â”€ UserServiceTest.java     # Unit Test
â”‚       â””â”€â”€ repository/
â”‚           â””â”€â”€ UserRepositoryTest.java  # @DataJpaTest
â””â”€â”€ integration/
    â””â”€â”€ UserIntegrationTest.java         # TestContainers
```

### 2. Repository í…ŒìŠ¤íŠ¸
```java
@DataJpaTest
@AutoConfigureTestDatabase(replace = AutoConfigureTestDatabase.Replace.NONE)
@Testcontainers
class UserRepositoryTest {
    
    @Container
    static PostgreSQLContainer<?> postgres = new PostgreSQLContainer<>("postgres:15-alpine");
    
    @Autowired
    private UserRepository userRepository;
    
    @Test
    @DisplayName("ì´ë©”ì¼ë¡œ ì‚¬ìš©ìë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤")
    void findByEmail() {
        // given
        User user = User.builder()
                .email("test@example.com")
                .password("password")
                .name("Test User")
                .build();
        userRepository.save(user);
        
        // when
        Optional<User> found = userRepository.findByEmail("test@example.com");
        
        // then
        assertThat(found).isPresent();
        assertThat(found.get().getEmail()).isEqualTo("test@example.com");
    }
}
```

### 3. Service í…ŒìŠ¤íŠ¸
```java
@ExtendWith(MockitoExtension.class)
class UserServiceTest {
    
    @Mock
    private UserRepository userRepository;
    
    @Mock
    private PasswordEncoder passwordEncoder;
    
    @InjectMocks
    private UserService userService;
    
    @Test
    @DisplayName("ì‚¬ìš©ìë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤")
    void createUser() {
        // given
        UserCreateRequest request = new UserCreateRequest();
        // ... set request fields
        
        given(userRepository.existsByEmail(anyString())).willReturn(false);
        given(passwordEncoder.encode(anyString())).willReturn("encodedPassword");
        given(userRepository.save(any(User.class))).willReturn(user);
        
        // when
        UserResponse response = userService.createUser(request);
        
        // then
        assertThat(response).isNotNull();
        verify(userRepository).save(any(User.class));
    }
}
```

### 4. Controller í…ŒìŠ¤íŠ¸
```java
@WebMvcTest(UserController.class)
@AutoConfigureMockMvc(addFilters = false)
class UserControllerTest {
    
    @Autowired
    private MockMvc mockMvc;
    
    @MockBean
    private UserService userService;
    
    @Autowired
    private ObjectMapper objectMapper;
    
    @Test
    @DisplayName("ì‚¬ìš©ì ìƒì„± APIë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤")
    void createUser() throws Exception {
        // given
        UserCreateRequest request = new UserCreateRequest();
        // ... set request
        
        UserResponse response = UserResponse.builder()
                .id(1L)
                .email("test@example.com")
                .build();
        
        given(userService.createUser(any(UserCreateRequest.class))).willReturn(response);
        
        // when & then
        mockMvc.perform(post("/api/users")
                .contentType(MediaType.APPLICATION_JSON)
                .content(objectMapper.writeValueAsString(request)))
                .andExpect(status().isCreated())
                .andExpect(jsonPath("$.id").value(1L))
                .andExpect(jsonPath("$.email").value("test@example.com"));
    }
}
```

---

## ğŸ“ ë¬¸ì„œí™” ê·œì¹™

### 1. Swagger ì–´ë…¸í…Œì´ì…˜
```java
@Tag(name = "User", description = "ì‚¬ìš©ì ê´€ë¦¬ API")
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    @Operation(
        summary = "ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ",
        description = "í•„í„° ì¡°ê±´ì— ë§ëŠ” ì‚¬ìš©ì ëª©ë¡ì„ í˜ì´ì§•í•˜ì—¬ ì¡°íšŒí•©ë‹ˆë‹¤."
    )
    @ApiResponses({
        @ApiResponse(responseCode = "200", description = "ì¡°íšŒ ì„±ê³µ"),
        @ApiResponse(responseCode = "401", description = "ì¸ì¦ ì‹¤íŒ¨"),
        @ApiResponse(responseCode = "403", description = "ê¶Œí•œ ì—†ìŒ")
    })
    @GetMapping
    public ResponseEntity<Page<UserResponse>> getUsers(
            @Parameter(description = "í˜ì´ì§€ ë²ˆí˜¸ (0ë¶€í„° ì‹œì‘)") @RequestParam(defaultValue = "0") int page,
            @Parameter(description = "í˜ì´ì§€ í¬ê¸°") @RequestParam(defaultValue = "20") int size) {
        // ...
    }
}
```

### 2. JavaDoc (ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë§Œ)
```java
/**
 * SR ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.
 * 
 * <p>ìŠ¹ì¸ ë‹¨ê³„:
 * 1. ìš”ì²­ë¶€ì„œ íŒ€ì¥ ìŠ¹ì¸
 * 2. IT ë¶€ì„œ ê²€í† 
 * 3. PM ìµœì¢… ìŠ¹ì¸
 * 
 * @param srId SR ID
 * @param request ìŠ¹ì¸ ìš”ì²­ ì •ë³´
 * @return ìŠ¹ì¸ëœ SR ì •ë³´
 * @throws SrNotFoundException SRì„ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš°
 * @throws InvalidApprovalStateException ìŠ¹ì¸í•  ìˆ˜ ì—†ëŠ” ìƒíƒœì¸ ê²½ìš°
 */
@Transactional
public SrResponse approveSr(Long srId, ApprovalRequest request) {
    // ...
}
```

---

## ğŸŒ¿ Git ë¸Œëœì¹˜ ì „ëµ

### Branch Naming
- `main`: ìš´ì˜ ë°°í¬ ë¸Œëœì¹˜
- `develop`: ê°œë°œ í†µí•© ë¸Œëœì¹˜
- `feature/[MVP-PHASE]-[FEATURE-NAME]`: ê¸°ëŠ¥ ê°œë°œ ë¸Œëœì¹˜
  - ì˜ˆ: `feature/mvp1-user-auth`, `feature/mvp2-sr-management`
- `bugfix/[ISSUE-NUMBER]`: ë²„ê·¸ ìˆ˜ì • ë¸Œëœì¹˜
- `hotfix/[ISSUE-NUMBER]`: ê¸´ê¸‰ ìˆ˜ì • ë¸Œëœì¹˜

### Commit Message Convention
```
[TYPE] ê°„ë‹¨í•œ ì„¤ëª… (50ì ì´ë‚´)

ìƒì„¸ ì„¤ëª… (ì„ íƒì‚¬í•­, 72ì ì¤„ë°”ê¿ˆ)

Related to: #123
```

**TYPE**:
- `feat`: ìƒˆë¡œìš´ ê¸°ëŠ¥
- `fix`: ë²„ê·¸ ìˆ˜ì •
- `refactor`: ë¦¬íŒ©í† ë§
- `docs`: ë¬¸ì„œ ìˆ˜ì •
- `test`: í…ŒìŠ¤íŠ¸ ì½”ë“œ
- `chore`: ë¹Œë“œ, ì„¤ì • ë³€ê²½

**ì˜ˆì‹œ**:
```
[feat] ì‚¬ìš©ì ë“±ë¡ API êµ¬í˜„

- UserCreateRequest DTO ì¶”ê°€
- UserService.createUser() ë©”ì„œë“œ êµ¬í˜„
- ì´ë©”ì¼ ì¤‘ë³µ ê²€ì¦ ë¡œì§ ì¶”ê°€

Related to: #10
```

---

## ğŸš€ ê°œë°œ ì›Œí¬í”Œë¡œìš°

### 1. ë¡œì»¬ ê°œë°œ í™˜ê²½ ì‹¤í–‰
```bash
# PostgreSQL ì‹¤í–‰
docker-compose up -d postgres

# Backend ì‹¤í–‰ (IDE ë˜ëŠ” Maven)
./mvnw spring-boot:run -Dspring-boot.run.profiles=dev

# ë˜ëŠ” ì „ì²´ Docker í™˜ê²½
docker-compose up
```

### 2. API í…ŒìŠ¤íŠ¸
- Swagger UI: `http://localhost:8080/swagger-ui.html`
- H2 Console (dev): `http://localhost:8080/h2-console`

### 3. ê°œë°œ ìˆœì„œ (Feature ë‹¨ìœ„)
1. Issue ìƒì„± ë° Branch ìƒì„±
2. Entity ì„¤ê³„ ë° Flyway Migration ì‘ì„±
3. Repository ì‘ì„± ë° í…ŒìŠ¤íŠ¸
4. Service ì‘ì„± ë° í…ŒìŠ¤íŠ¸
5. Controller ì‘ì„± ë° í…ŒìŠ¤íŠ¸
6. Swagger ë¬¸ì„œ í™•ì¸
7. PR ìƒì„± ë° ë¦¬ë·°
8. Merge to develop

---

## âš™ï¸ í™˜ê²½ ì„¤ì •

### application.yml (ê³µí†µ)
```yaml
spring:
  application:
    name: aris
  
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        format_sql: true
        default_batch_fetch_size: 100
  
  flyway:
    enabled: true
    baseline-on-migrate: true

jwt:
  secret: ${JWT_SECRET:your-secret-key-must-be-at-least-256-bits-long}
  access-token-validity: 3600000  # 1 hour
  refresh-token-validity: 604800000  # 7 days

springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha
```

### application-dev.yml (ê°œë°œ)
```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/aris_db
    username: aris_user
    password: aris_password
  
  jpa:
    show-sql: true
    properties:
      hibernate:
        format_sql: true

logging:
  level:
    com.aris: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
```

---

## ğŸ“Œ ì¤‘ìš” ì›ì¹™

### DO âœ…
- EntityëŠ” ì§ì ‘ ë°˜í™˜í•˜ì§€ ë§ê³  DTOë¡œ ë³€í™˜
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ Service Layerì— ì‘ì„±
- @Transactionalì€ Service Layerì—ë§Œ ì‚¬ìš©
- Soft Delete ì›ì¹™ ì¤€ìˆ˜
- ì˜ˆì™¸ëŠ” ëª…í™•í•œ ErrorCodeì™€ í•¨ê»˜ ë°œìƒ
- í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± (ìµœì†Œ ì»¤ë²„ë¦¬ì§€ 80%)
- Swagger ë¬¸ì„œ ì‘ì„±
- Git Commit Convention ì¤€ìˆ˜

### DON'T âŒ
- Controllerì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‘ì„± ê¸ˆì§€
- Entityë¥¼ ì§ì ‘ Request/Responseë¡œ ì‚¬ìš© ê¸ˆì§€
- ë¬¼ë¦¬ì  ì‚­ì œ ê¸ˆì§€ (deletedAt ì‚¬ìš©)
- í•˜ë“œì½”ë”©ëœ ìƒìˆ˜ ì‚¬ìš© ê¸ˆì§€ (Enum ì‚¬ìš©)
- N+1 ë¬¸ì œ ë°©ì¹˜ ê¸ˆì§€
- íŠ¸ëœì­ì…˜ ë²”ìœ„ ê³¼ë„í•˜ê²Œ ë„“íˆì§€ ë§ê¸°
- @Transactional(readOnly = true) ì—†ì´ ì¡°íšŒ ê¸ˆì§€
- í…ŒìŠ¤íŠ¸ ì—†ì´ PR ê¸ˆì§€

---

## ğŸ”„ Phaseë³„ ê°œë°œ ìš°ì„ ìˆœìœ„

### MVP Phase 1 (2-3ì£¼)
1. Spring Boot í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì •
2. Docker & PostgreSQL í™˜ê²½ êµ¬ì¶•
3. BaseEntity, AuditingConfig êµ¬í˜„
4. User, Role, Company Entity ì„¤ê³„
5. JWT ì¸ì¦/ì¸ê°€ êµ¬í˜„
6. ì‚¬ìš©ì CRUD API êµ¬í˜„
7. Swagger ë¬¸ì„œí™”

### MVP Phase 2 (3-4ì£¼)
1. Project Entity ì„¤ê³„
2. SR (ServiceRequest) Entity ì„¤ê³„
3. Spec Entity ì„¤ê³„
4. Approval Entity ë° Workflow ì„¤ê³„
5. SR CRUD API êµ¬í˜„
6. Spec CRUD API êµ¬í˜„
7. ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ API êµ¬í˜„
8. íŒŒì¼ ì²¨ë¶€ ê¸°ëŠ¥ êµ¬í˜„

### MVP Phase 3 (4-5ì£¼)
1. Issue Entity ì„¤ê³„
2. Release Entity ì„¤ê³„
3. Incident Entity ì„¤ê³„
4. ì´ìŠˆ/ë¦´ë¦¬ì¦ˆ/ì¥ì•  ê´€ë¦¬ API êµ¬í˜„
5. í†µê³„ API êµ¬í˜„
6. ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬í˜„
7. ë°°ì¹˜ ì‘ì—… êµ¬í˜„
8. íŒŒíŠ¸ë„ˆ/ìì‚° ê´€ë¦¬ API êµ¬í˜„

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Spring Boot Documentation](https://docs.spring.io/spring-boot/docs/current/reference/html/)
- [Spring Data JPA](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/)
- [Spring Security](https://docs.spring.io/spring-security/reference/index.html)
- [PostgreSQL Documentation](https://www.postgresql.org/docs/)
- [Flyway Documentation](https://flywaydb.org/documentation/)
- [TestContainers](https://www.testcontainers.org/)

---

**Last Updated**: 2025-10-15
**Version**: 1.0.0









